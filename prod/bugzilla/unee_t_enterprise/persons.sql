CREATE TABLE `persons` (
  `id_person` int(11) NOT NULL AUTO_INCREMENT COMMENT 'unique ID in this table',
  `external_id` varchar(255) COLLATE utf8mb4_unicode_520_ci NOT NULL COMMENT 'The id of the record in an external system',
  `external_system` varchar(255) COLLATE utf8mb4_unicode_520_ci NOT NULL COMMENT 'The id of the system which provides the external_system_id',
  `external_table` varchar(255) COLLATE utf8mb4_unicode_520_ci NOT NULL COMMENT 'The table in the external system where this record is stored',
  `syst_created_datetime` timestamp NULL DEFAULT NULL COMMENT 'When was this record created?',
  `creation_system_id` int(11) DEFAULT NULL COMMENT 'What is the id of the sytem that was used for the creation of the record?',
  `created_by_id` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'The MEFE ID of the user who created this record',
  `creation_method` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'How was this record created',
  `syst_updated_datetime` timestamp NULL DEFAULT NULL COMMENT 'When was this record last updated?',
  `update_system_id` int(11) DEFAULT NULL COMMENT 'What is the id of the sytem that was used for the last update the record?',
  `updated_by_id` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'The MEFE ID of the user who updated this record',
  `update_method` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'How was this record updated?',
  `organization_id` int(11) unsigned NOT NULL COMMENT 'a FK to the table `uneet_enterprise_organizations` The ID of the organization that created this record',
  `person_status_id` int(11) DEFAULT '1' COMMENT 'The id of the person status in the table 164_person_statuses',
  `dupe_id` int(11) DEFAULT NULL COMMENT 'This is a duplicate of this other record in this table',
  `handler_id` int(11) DEFAULT NULL COMMENT 'id of the person in charge of this person in the organization',
  `is_unee_t_account_needed` tinyint(1) DEFAULT '0' COMMENT '1 if we have decided to create a Unee-T account for that person',
  `unee_t_user_type_id` int(11) DEFAULT NULL COMMENT 'The type of unee-T user profile we create for this person. This is a FK to tyhe table `ut_unee_t_user_types`',
  `country_code` varchar(10) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'The 2 letter version of the country code',
  `gender` tinyint(1) DEFAULT '0' COMMENT '0: Unknown; 1: Male; 2: Female',
  `salutation_id` int(11) DEFAULT '1' COMMENT 'The salutation, a link to the table 150_salutations',
  `given_name` varchar(255) COLLATE utf8mb4_unicode_520_ci NOT NULL COMMENT 'given name',
  `middle_name` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'middle name',
  `family_name` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'family name',
  `date_of_birth` date DEFAULT NULL COMMENT 'The birth date of the person',
  `alias` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'V4.35.0 - an Alias for the person',
  `job_title` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'The job title of the person in the company',
  `organization` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'In which organization inside the company is the person working on?',
  `email` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'The primary email address of the person',
  `tel_1` varchar(50) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'Primary phone number for the person',
  `tel_2` varchar(50) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'Secondary Phone number for the person',
  `whatsapp` varchar(50) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'whatsapp id for that person',
  `linkedin` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'the url to the linkedin profile of that person',
  `facebook` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL COMMENT 'the url to the facebook profile for that person',
  `adr1` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL,
  `adr2` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL,
  `adr3` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL,
  `City` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL,
  `zip_postcode` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL,
  `region_or_state` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL,
  `country` varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL,
  PRIMARY KEY (`external_id`,`external_system`,`external_table`,`organization_id`),
  UNIQUE KEY `unique_person_id` (`id_person`),
  UNIQUE KEY `in_an_organization_person_main_email_must_be_unique` (`email`,`organization_id`),
  KEY `person_person_salutation` (`salutation_id`),
  KEY `person_person_status` (`person_status_id`),
  KEY `person_unee-t_user_type` (`unee_t_user_type_id`),
  KEY `sot_creation_system_person` (`creation_system_id`),
  KEY `sot_update_system_person` (`update_system_id`),
  KEY `person_organization_id` (`organization_id`),
  CONSTRAINT `person_organization_id` FOREIGN KEY (`organization_id`) REFERENCES `uneet_enterprise_organizations` (`id_organization`) ON UPDATE CASCADE,
  CONSTRAINT `person_person_salutation` FOREIGN KEY (`salutation_id`) REFERENCES `person_salutations` (`id_salutation`) ON UPDATE CASCADE,
  CONSTRAINT `person_person_status` FOREIGN KEY (`person_status_id`) REFERENCES `person_statuses` (`id_person_status`) ON UPDATE CASCADE,
  CONSTRAINT `person_unee-t_user_type` FOREIGN KEY (`unee_t_user_type_id`) REFERENCES `ut_user_types` (`id_unee_t_user_type`) ON UPDATE CASCADE,
  CONSTRAINT `sot_creation_system_person` FOREIGN KEY (`creation_system_id`) REFERENCES `ut_external_sot_for_unee_t_objects` (`id_external_sot_for_unee_t`) ON UPDATE CASCADE,
  CONSTRAINT `sot_update_system_person` FOREIGN KEY (`update_system_id`) REFERENCES `ut_external_sot_for_unee_t_objects` (`id_external_sot_for_unee_t`) ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_520_ci ROW_FORMAT=DYNAMIC;
